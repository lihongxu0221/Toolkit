using Microsoft.CodeAnalysis;using Microsoft.CodeAnalysis.CSharp;using Microsoft.CodeAnalysis.CSharp.Syntax;namespace BgCommon.Script;/// <summary>/// 提供对脚本源代码进行静态分析的工具类./// </summary>public static class ScriptMetadataParser{    /// <summary>    /// 从脚本代码中提取顶部的 XML 文档注释或说明.    /// </summary>    /// <param name="code">脚本内容.</param>    public static string GetSummary(string code)    {        if (string.IsNullOrWhiteSpace(code))        {            return string.Empty;        }        var syntaxTree = CSharpSyntaxTree.ParseText(code);        var root = syntaxTree.GetCompilationUnitRoot();        // 寻找第一个成员或整个文档的琐碎内容（Trivia）        var comment = root.GetLeadingTrivia()            .FirstOrDefault(t => t.IsKind(SyntaxKind.SingleLineDocumentationCommentTrivia) ||                                 t.IsKind(SyntaxKind.MultiLineCommentTrivia));        return comment.ToString().Trim('/', '*', ' ', '\r', '\n');    }}