namespace BgCommon.Localization;/// <summary>/// 特定区域性的一组本地化字符串./// </summary>#nullable enablepublic class LocalizationSet{    private readonly Assembly? assembly;    private readonly string? name = string.Empty;    private readonly bool isPublic;    private readonly CultureInfo culture;    private readonly IEnumerable<KeyValuePair<string, string?>> strings;    /// <summary>    /// Gets 资源所在程序集.    /// </summary>    public Assembly? Assembly => assembly;    /// <summary>    /// Gets 资源包名称全路径.    /// </summary>    public string? Name => name;    /// <summary>    /// Gets a value indicating whether gets 是否为公共多语言包集合.    /// </summary>    public bool IsPublic => isPublic;    /// <summary>    /// Gets 本地化对应的语言集.    /// </summary>    public CultureInfo Culture => culture;    /// <summary>    /// Gets 本地化字符串字典.    /// </summary>    public IEnumerable<KeyValuePair<string, string?>> Strings => strings;    /// <summary>    /// Initializes a new instance of the <see cref="LocalizationSet"/> class.    /// </summary>    /// <param name="assembly">本地化程序集.</param>    /// <param name="name">本地化集的名称。这可能是资源文件的名称或其他标识符.</param>    /// <param name="culture">本地化字符串所针对的语言集.</param>    /// <param name="strings">此集合中的本地化字符串.</param>    /// <param name="isPublic">是否为公用的.</param>    public LocalizationSet(Assembly? assembly, string name, CultureInfo culture, IEnumerable<KeyValuePair<string, string?>> strings, bool isPublic)    {        this.assembly = assembly;        this.name = name;        this.culture = culture;        this.strings = strings;        this.isPublic = isPublic;    }    /// <summary>    /// 根据指定的键获取本地化字符串.    /// </summary>    /// <param name="key">本地化键名.</param>    /// <returns>找到的本地化值；如果未找到则返回键名本身.</returns>    public string? this[string key]    {        get        {            foreach (KeyValuePair<string, string?> localizationString in Strings)            {                if (localizationString.Key == key)                {                    return localizationString.Value;                }            }            return key;        }    }    /// <summary>    /// 检查集合中是否包含指定的本地化键.    /// </summary>    /// <param name="key">要检查的键名.</param>    /// <returns>如果包含则返回 true，否则返回 false.</returns>    public bool ContainKey(string key)    {        return Strings.Any(e => e.Key == key);    }    /// <summary>    /// 检查此本地化集合是否适用于指定的程序集.    /// </summary>    /// <param name="assemblyName">待验证的程序集名称.</param>    /// <returns>如果此集合是公共的，或者其所属程序集与指定名称一致，则返回 true；否则返回 false.</returns>    public bool IsApplicableTo(string? assemblyName)    {        // 如果该集合被标记为公共集合 (Public)，则它适用于任何程序集        if (this.isPublic)        {            return true;        }        // 如果程序集引用丢失或传入的名称为空，根据逻辑上下文视为通过（或根据业务调整为不通过）        if (this.assembly == null || string.IsNullOrEmpty(assemblyName))        {            return true;        }        // 比较本地化集所属程序集的名称与目标名称是否匹配        return this.assembly.GetName()?.Name == assemblyName;    }}