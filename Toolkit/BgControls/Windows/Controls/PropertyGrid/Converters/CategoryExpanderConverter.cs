namespace BgControls.Windows.Controls.PropertyGrid.Converters;public class CategoryExpanderConverter : IMultiValueConverter{    /// <inheritdoc/>    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)    {        if (values.Length != 3 ||            values[0] == DependencyProperty.UnsetValue ||            values[1] == DependencyProperty.UnsetValue ||            values[2] == DependencyProperty.UnsetValue)        {            return true;        }        bool isCategoryExpanded = (bool)values[0];        var property = values[1] as CustomPropertyItem;        if (values[2] is ReadOnlyObservableCollection<object> propertyItems)        {            foreach (object item in propertyItems)            {                if (item is CustomPropertyItem customPropertyItem &&                    !object.Equals(customPropertyItem, property))                {                    customPropertyItem.IsCategoryExpanded = isCategoryExpanded;                }            }            if (propertyItems[0] is PropertyItem propertyItem)            {                PropertyItem temp = propertyItem;                PropertyGrid? propertyGrid = temp.ParentElement as PropertyGrid;                while (propertyGrid == null && temp.ParentElement != null)                {                    if (temp.ParentElement is PropertyItem propertyItem1)                    {                        temp = propertyItem1;                        continue;                    }                    if (temp.ParentElement is PropertyGrid propertyGrid1)                    {                        propertyGrid = propertyGrid1;                    }                }                propertyGrid?.RaiseCategoryRoutedEvent(isCategoryExpanded ? PropertyGrid.CategoryExpandedEvent : PropertyGrid.CategoryCollapsedEvent, propertyItem.Category);            }        }        return isCategoryExpanded;    }    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)    {        return new object[1] { value };    }}