using BgControls.Windows.Controls;namespace BgControls.Tools.Converter;/// <summary>/// 消息条（Snackbar）操作按钮布局模式转换器，用于根据高度和模式计算按钮停靠位置./// </summary>public class SnackbarActionButtonPlacementModeConverter : IMultiValueConverter{    /// <summary>    /// Initializes a new instance of the <see cref="SnackbarActionButtonPlacementModeConverter"/> class.    /// </summary>    public SnackbarActionButtonPlacementModeConverter()    {    }    /// <summary>    /// 将多个绑定值转换为单一的停靠位置结果.    /// </summary>    /// <param name="values">绑定源值数组：[0]布局模式, [1]行内最大高度, [2]实际高度.</param>    /// <param name="targetType">目标属性类型.</param>    /// <param name="parameter">转换器参数.</param>    /// <param name="culture">区域性信息.</param>    /// <returns>返回 Dock 枚举值，指示按钮停靠方向.</returns>    public object Convert(object[] values, Type targetType, object parameter, CultureInfo culture)    {        // 验证输入数组是否为空.        ArgumentNullException.ThrowIfNull(values, nameof(values));        // 检查数组长度以及第一个元素是否有效，防止绑定未就绪时的异常.        if (values.Length < 3 || values[0] == null || values[0] == BindingOperations.DisconnectedSource)        {            return Dock.Right;        }        // 解析布局模式枚举值.        SnackbarActionButtonPlacementMode placementMode = (SnackbarActionButtonPlacementMode)values[0];        // 解析行内模式允许的最大高度.        double inlineMaxHeight = (values[1] as double?) ?? 0.0;        // 解析当前控件的实际高度.        double actualHeight = (values[2] as double?) ?? 0.0;        // 根据布局模式逻辑返回对应的停靠位置.        return placementMode switch        {            // 自动模式：如果实际高度超过行内最大高度，则停靠在底部（分行显示），否则停靠在右侧（行内显示）.            SnackbarActionButtonPlacementMode.Auto => (actualHeight > inlineMaxHeight) ? Dock.Bottom : Dock.Right,            // 强制行内模式：始终停靠在右侧.            SnackbarActionButtonPlacementMode.Inline => Dock.Right,            // 强制分行模式：始终停靠在底部.            SnackbarActionButtonPlacementMode.SeparateLine => Dock.Bottom,            // 默认返回右侧停靠.            _ => Dock.Right,        };    }    /// <summary>    /// 不支持从目标值到源值的反向转换.    /// </summary>    /// <param name="value">目标值.</param>    /// <param name="targetTypes">源类型数组.</param>    /// <param name="parameter">转换器参数.</param>    /// <param name="culture">区域性信息.</param>    /// <returns>不返回任何值，始终抛出异常.</returns>    /// <exception cref="InvalidOperationException">数学多值转换不支持反向转换.</exception>    public object[] ConvertBack(object value, Type[] targetTypes, object parameter, CultureInfo culture)    {        // 按照逻辑抛出不支持操作的异常.        throw new InvalidOperationException("不支持反向转换.");    }}