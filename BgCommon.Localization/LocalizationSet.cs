using System.Reflection;namespace BgCommon.Localization;/// <summary>/// 特定区域性的一组本地化字符串。/// </summary>/// <param name="Name">本地化集的名称。这可能是资源文件的名称或其他标识符。</param>/// <param name="Culture">本地化字符串所针对的语言集</param>/// <param name="Strings">此集合中的本地化字符串。</param>#nullable enablepublic class LocalizationSet{    private readonly Assembly? assembly;    private readonly string? name = string.Empty;    private readonly bool isPublic = false;    private readonly CultureInfo culture;    private readonly IEnumerable<KeyValuePair<string, string?>> strings;    /// <summary>    /// Gets 资源所在程序集    /// </summary>    public Assembly? Assembly => assembly;    /// <summary>    /// Gets 资源包名称全路径    /// </summary>    public string? Name => name;    /// <summary>    /// Gets a value indicating whether gets 是否为公共多语言包集合    /// </summary>    public bool IsPublic => isPublic;    /// <summary>    /// Gets 本地化对应的语言集    /// </summary>    public CultureInfo Culture => culture;    /// <summary>    /// Gets 本地化字符串字典    /// </summary>    public IEnumerable<KeyValuePair<string, string?>> Strings => strings;    public LocalizationSet(Assembly? assembly, string name, CultureInfo culture, IEnumerable<KeyValuePair<string, string?>> strings, bool isPublic)    {        this.assembly = assembly;        this.name = name;        this.culture = culture;        this.strings = strings;        this.isPublic = isPublic;    }    public string? this[string key]    {        get        {            foreach (KeyValuePair<string, string?> localizationString in Strings)            {                if (localizationString.Key == key)                {                    return localizationString.Value;                }            }            return key;        }    }    public bool ContainKey(string key)    {        return Strings.Any(e => e.Key == key);    }    /// <summary>    /// 调用的程序集是否相同    /// </summary>    /// <param name="assemblyName">程序集名称</param>    /// <returns>是否相同</returns>    public bool IsSame(string? assemblyName)    {        if (IsPublic || assembly == null || string.IsNullOrEmpty(assemblyName))        {            return true;        }        return assembly.GetName()?.Name == assemblyName;    }}