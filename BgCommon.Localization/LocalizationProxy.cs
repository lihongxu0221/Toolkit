namespace BgCommon.Localization;/// <summary>/// BgCommon.Localization 类库下的本地化字符串./// </summary>public partial class LocalizationProxy : INotifyPropertyChanged{    private static readonly Lazy<LocalizationProxy> lazyInstance = new Lazy<LocalizationProxy>(() => new LocalizationProxy());    /// <summary>    /// Gets 获取全局唯一的 LocalizationStrings 实例.    /// </summary>    public static LocalizationProxy Instance => lazyInstance.Value;    private LocalizationProxy()    {    }    /// <summary>    /// 索引器属性.WPF 绑定将使用这个属性来获取本地化字符串.    /// 例如，绑定路径 "[WelcomeMessage]" 会调用 this["WelcomeMessage"].    /// </summary>    /// <param name="key">资源键 (例如 "WelcomeMessage").</param>    public string this[string key] => LocalizationProviderFactory.GetString(key);    /// <summary>    /// 当属性值发生变化时发生。用于支持数据绑定中的动态语言切换.    /// </summary>    public event PropertyChangedEventHandler? PropertyChanged;    /// <summary>    /// 触发 PropertyChanged 事件.    /// </summary>    /// <param name="propertyName">发生变更的属性的名称.</param>    private void OnPropertyChanged([CallerMemberName] string? propertyName = null)    {        PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));    }    /// <summary>    /// 公共方法，用于触发所有绑定的更新.    /// </summary>    public void RaiseAllPropertiesChanged()    {        // "[IndexerName]" 是一个特殊语法，WPF 用它来表示索引器属性已更改.        // 这会强制所有通过索引器进行的绑定（例如 Binding [WelcomeMessage]）重新求值.        this.OnPropertyChanged(string.Empty);    }    // /// <summary>    // /// 公共方法，用于触发所有绑定的更新.    // /// </summary>    // public partial void OnAllPropertiesChanged();    /// <summary>    /// 切换应用程序的本地化文化.    /// </summary>    /// <param name="culture">要切换的应用程序的本地文化.</param>    public static void SetLocalizationCulture(CultureInfo culture)    {        CultureInfo.CurrentUICulture = culture;        CultureInfo.DefaultThreadCurrentUICulture = culture;        LocalizationProviderFactory.GetInstance()?.SetCulture(culture);        Instance.RaiseAllPropertiesChanged();    }    /// <summary>    /// 获取多语言字符串资源.    /// </summary>    /// <param name="key">关键字.</param>    /// <param name="args">可变格式化字符串参数.</param>    /// <returns>多语言字符串资源.</returns>    public static string GetString(string key, params object[] args)    {        Assembly assembly = Assembly.GetCallingAssembly();        return GetString(assembly, key, args);    }    /// <summary>    /// 获取多语言字符串资源.    /// </summary>    /// <param name="assembly">资源包所在程序集.</param>    /// <param name="key">关键字.</param>    /// <param name="args">可变格式化字符串参数.</param>    /// <returns>多语言字符串资源.</returns>    public static string GetString(Assembly assembly, string key, params object[] args)    {        string assemblyName = assembly.GetName()?.Name ?? string.Empty;        return LocalizationProviderFactory.GetString(assemblyName, key, args);    }    /// <summary>    /// 获取指定关键字对应的的全部语言字符串数组.    /// </summary>    /// <param name="key">关键字.</param>    /// <param name="assembly">程序集.</param>    /// <returns>返回 全部语言字符串数组.</returns>    public static string[] GetStrings(string key, Assembly? assembly = null)    {        return LocalizationProviderFactory.GetStrings(key, assembly?.GetName().Name);    }}